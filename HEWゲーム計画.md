# HEWゲーム計画
- [HEWゲーム計画](#HEWゲーム計画)
  * [実現したい機能](#実現したい機能)
  * [追加必要な機能](#追加必要な機能)
  * [ゲーム大体の流れとシーン設計書](#ゲーム大体の流れとシーン設計書)
    + [流れ説明](#流れ説明)
    + [シーン設計](#シーン設計)
  * [制作段階計画](#制作段階計画)
    + [第一段階](#第一段階)
    + [第二段階](#第二段階)
    + [第三段階](#第三段階)
    + [第四段階](#第四段階)
    + [第五段階](#第五段階)

------
## 実現したい機能
- ~~横になるのプラットフォームゲーム~~
- ~~フックロープを中心に謎を解き、前に進む（ものを取るあるいは障害を飛び越す）~~
- ~~必要な道具を取った後あるドーアが開く~~
- ~~矢で敵を攻撃~~
- 冬休みより大きなスプライト使用する予定
- ~~重力とぶつかり合いと~~定速移動
- 経営ゲームみたいなゲーム
- 施設で観光客に良い一日を与えるという目的
- 有限な資金とスペースに施設作成
- 観光客種類や数、施設の種類とそれぞれ行われるイベントのレベルと順位によって評価を決定
- 動画を実用する予定
- もし余裕があればネットにクリア時間記録を残す（開発者含み・開発者抜き）
- CLIエンジン可能な部分再利用
- 音楽付けて行う

------
## 追加必要な機能
- 基本部分
    - 音楽再生
    - スプライト（シーン機能とまとめて）
        - スプライト集合体：一ものに対して複数のスプライトがあるのはいい
        - 動画に対して色んなスプライト集合体が必要
- ミドルウェア部分
    - 重力と立てる地面
    - 動画表現

------
## ゲーム大体の流れとシーン設計書
### 流れ説明
タイトル画面➝基本紹介➝ステージ選択、
ステージ選択➝観光客情報➝リゾートに名前付く➝有限な資金とスペースに施設作成（演出付き、時限を加えて）➝作成完了（一覧表示）、
作成完了➝観光客に解禁➝施設の順位で各施設に遊ぶ（演出付き）➝段階感想発表➝最後まで繰り返す➝全体的感想発表➝結果表示（演出付き）、
結果表示➝リトライ➝観光客情報．．．
### シーン設計
- タイトルシーン
    ボタンの位置と内容を決める
    タイトル画面と細かいところを第四段階の時作成
    ボタン：新規開始、ロード、操作方法、リンク
- 話し合いシーン
    下に文字表現されるのUI、上の部分に演出できるようのカメラバッファ
    UI部分：喋っている人の名前、喋られている言、浮かべているスプライトとボタン、skipボタン
- 名前付きシーン
    観光客情報表示、名前選択（XXい・XXな・XXの　+　YY）
    二つの子UI：形容詞　＋　名詞
- 施設作成とイベント作成シーン
    大体のレイアウトは冬休みのMazeシーンと同じでよい
    左右のボタン、資金かかり、施設の種類、経営方針・イベント、完成ボタン
- リゾート全体シーン
    全部カメラバッファにする
- 施設とイベントシーン
    下に加速ボタン
- 全体感想発表シーン
    アニメ表現で行う、ボタンなし
- 最終結果シーン
    結果発表演出、解禁したらその情報表示、セーブ、ステージに戻る
------
## 制作段階計画
### 第一段階
- [１月２４日完成]    ~~[２月５日まで]~~
- 追加予定の機能を追加する
- 開発ログ
    - スプライトに関して
        色付きのスプライトはだめみたい、性能がごく限られたのでしばらく放置
        キャラ型のスプライトバッファに再び採用
        １月２０日スプライトとそれによってのアニメタル完成、オフセットに通じて異なったキーフレームに設定可能（今は更新用バッファに書き込むだがこの後シーンバッファに変更予定）
    - 音楽再生に関して
        開発予定はある配列に音楽ファイル格納したポインタとファイルサイズ保存して、必要な時取り出すという仕組み。そして再生したい場合一つのスレッド作成して音楽再生する、そのスレッドのハンドルを保存して再生停止の場合このスレッドを削除する
        １月２１日ＢＧＭ再生になりました
        １月２２日基本の部分は完成したが、マルチスレッドで実現は不可能と示している、今週末マルチプロセスで試す予定です、もし失敗したら背景音楽だけ再生するの形で行うになるでしょう。
        ヒープメモリに重大なバグを起こるようだ、自分で開発された音声システムはしばらく放置、conioexで行う
        １月２４日conioexで音声システムを再構成した、音声システム完了
    - 重力部分に関して
        今回のゲーム案にジャンプ必要がなさそうので作業しません

### 第二段階
- [１月２７日完成]    ~~[１月２９日まで]~~    ~~[２月１０日まで]~~
- 基本のシーン声明と変換を完成する
- 開発ログ
    - 【0125完成】タイトルのUIOs
    - 【0125完成】話し合いのUIOs
    - 【0125完成】名前選択のUIOs
    - 【0125完成】作成部分のUIOs
    - 【0125完成】最終結果のUIOs
    - 【0126完成】ステージ選択のUIOs
    - タイトルシーン
        - 【0126完成】基本の枠完成
        各説明は未だ、シーン変更も未だ、セーブデータも未だ、背景演出も未だ。
        - 【0126完成】新規開始のシーン変更完成
        各説明は未だ、ロードでシーン変更も未だ、セーブデータも未だ、背景演出も未だ。
    - 話し合いシーン
        - 【0126完成】基本の枠完成、新規会話あるいは引き続きの標識完成
        対話データ読み込み方は未だ、次の内容ボタンも未だ、人物スプライトも未だ
        - 【0127完成】次の内容ボタンエフェクト完成、スプライトアニメタル追加完了
        対話データ読み込み方は未だ、人物スプライトも未だ
    - 【0127完成】変換エフェクトシーン
        - 【0126完成】基本の変換方式は定めだ
        エフェクト自身は未だ
        - 【0126完成】エフェクト自身完成
        乱数で方向を設定、今見るとこのシーンもう完成した（機能追加しないように）
        - 【0127完成】縦方向の密度を下げた
        機能追加しないように
    - ステージ選択シーン
        - 【0127完成】基本の枠完成
        各ステージの演出は未だ
    - 名前選択シーン
        - 【0127完成】基本の枠完成
        観光客情報表示の演出は未だ、名前変更も未だ
    - 作成部分シーン
        - 【0127完成】基本の枠完成
        内容マッピングは未だ、選択されたものもまだ、作成部分全部まだ、演出も未だ、施設情報表示も未だ、資金処理も未だ、クソまだだらけじゃん
    - リゾートシーン
        - 【0127完成】基本の枠完成
        他のは何もできていない
    - イベントシーン
        - 【0127完成】基本の枠完成
        他のは何もできていない
    - 全体感想シーン
        - 【0127完成】基本の枠完成
        他のは何もできていない、演出もまだ
    - 最終結果シーン
        - 【0127完成】基本の枠完成
        他のは何もできていない、演出もまだ
    - 【0130追加create-visitors】【0127完成】基本のシーン変更完成、注意すべき点まとめ:
        - UIアイテム名前
            - "empty": 何もないのＵＩアイテム
            - "title": タイトルＵＩアイテム
            - "load-data": ロードＵＩアイテム
            - "manual": 操作方法ＵＩアイテム
            - "link": 関連リンクＵＩアイテム
            - "dialog": 対話ＵＩアイテム
            - "stage-select": ステージ選択ＵＩアイテム
            - "naming": 名前付きＵＩアイテム
            - "create-visitors": 作成中と提示するＵＩアイテム
            - "subname1": 形容詞ＵＩアイテム
            - "subname2": 名詞ＵＩアイテム
            - "build": 施設作成メインＵＩアイテム
            - "build-type": 施設種類ＵＩアイテム
            - "build-event": 施設内容ＵＩアイテム
            - "final-result": 最終結果ＵＩアイテム
            - "save-data": セーブＵＩアイテム
        - シーン名前
            - "switch-effect": 各シーンの間に変更する時のエフェクト
            - "test": テスト用シーン
            - "title": タイトル関連のシーン
            - "dialog": 対話を行うシーン
            - "select": ステージ選択シーン
            - "naming": 名前付きと観光客情報表示のシーン
            - "build": 施設作成と一覧のシーン
            - "resort": 観光客が遊ぶのシーン
            - "event": 各施設に内容によっての演出のシーン
            - "feeling": 最終感想のシーン
            - "result": 最終結果に関して演出のシーン
        - 臨時的ボタン
            - "TEMP_BTN_DIALOG_1": 対話イベント番号によって目標シーンに直接変更する
            - "TEMP_BTN_BUILDING_1": 何も作成せずに次のシーンに変更

### 第三段階
- [２月８日まで]    ~~[２月１０日まで]~~    ~~[２月２２日まで]~~
- 各ゲーム対象物を完成する（以下の内容は第四段階の作業も含んでいる）
    - 対話表示、推進、カメラバッファにスプライトアニメタル表示
    - 観光客情報作成、保存、リゾート名前置き換え、保存、演出
    - リゾート実体、buildシーンにリゾートマッピング、施設配列、施設情報、演出、保存、一覧
    - 観光客遊ぶ部分、ぶつかり合い、スプライトアニメタルで表示、一定の速度で移動
    - 施設の内容によっての演出と段階感想、各施設の繰り返す処理
    - 感想発表の演出、最終結果発表の演出
    - データ保存、再ロード
    - 各音声設定、タイトル画面の演出、ステージ選択の演出、各ステージの背景演出
- 開発ログ
	- 【0129一応完成】対話表示
	番号でファイルを読み込む、とあるところに保存して、getstring() かつgetchar()!=EOFで行う予定、64以内という上限で。対話完了後番号でシーン変更を行う。グローバル変数で二つのスプライトアニメタルを保存、読み込まれたスプライトアニメタルを配列で保存、シーン変換を行う後必要なスプライトアニメタルを再ロードしてカメラバッファに使用
    【0128】シングル対話ファイルを読めるになる
    【0128】エフェクトなしで対話実行出来上がる、次はスプライト効果、余裕があればエフェクトを作成する
    【0128】スプライトアニメタル付き完了、でも喋っているひとがいつも左になきゃダメので、直す必要があります
    【0128】順で左右切り替えで表示完了、ですがも一回表示させるとバグがある、なおしなきゃ
    【0128】バグがフィクスされた、この部分残られたのは文字表現エフェクトのみ、第四段階に作業するでも大丈夫
    【0129】面倒くさい部分を関数化された、キー要素をここにまとめ
        - スプライトアニメタルに対してカメラバッファに書き込むとき制限を追加した
        - 対話イベントロード：AppDeclared.cpp->InitAndLoadDialogEvent()
        - 行いたいイベントはDialogShower.cppのgp_GoingDialogEventを設定すればいい
        - DialogShower.cpp->SetPreSprite()とSwitchSprite()でスプライトを更新
	- 【0130一応完成】名前付けシーンの処理
	まずは観光客の情報の作成と保存を工夫する予定
    AppDeclaredに観光客情報を保存する、タイトル画面に戻る時消す、3~4種類かつ各種類1~3人
    ボタンの番号でＵＩアイテムのそれに応じているテキストを変更、そして名前と種類を保存する
    演出は生成された内容によって一人ずつ表示され、そして“+1”でスプライト表示してしたＵＩアイテムのテキストを変更という形で行う
    対話イベントも作成して追加する
    観光客の種類
        学生、カップル、プログラマー、アーティスト、事務員、親子、鯨、らくだ、うさぎ
    形容詞と名詞は同じく15個
        形容詞：涼しい、明るい、あまずっぱい、尊い、深い
        形容動詞：イコール、一時的、架空、グローバル、空気読めない
        形容用名詞：タピオカ、わたあめ、パンダ、世界、サラリーマン
        名詞：空気、リゾート、森、ラーメン屋、英雄、喫茶店、山、海、キャンプ場、事務所、荘、島、パレス、村、パラダイス
    +StageManager 選べられたステージの保存と読み出す
    +VisitorManager 観光客情報生成、保存、取り出す、テキストを変更
    +VisitorShower 観光客をこのシーンにスプライトアニメタルで表示する
    +ResortNameManager リゾートの名前と種類を保存する、必要の時取り出せるになれる
    【0130】観光客作成出来た、表示アニメタルはまだ
    【0130】表示アニメタルとまとめ部分が出来た、ボタン処理はまだ
    【0130】ボタン処理出来た、各ボタンの意味はまだ、でも階段四で行うでも大丈夫かも
    - リゾート施設作成など
    プレイヤーのスプライトアニメタル、下向きの矢印で表示、リゾート本体のバッファ
    三分の一を土になり、残りを演出用になる
    背景演出、いまプレイヤーの位置によってスプライトアニメタルの位置変換
    施設保存用の配列、臨時的な施設保存用の配列
    施設の種類、確定前明滅で表現する、イベントの内容（種類を選択する前、空白のは使えない）
    確定の演出、金使い、再編集
    施設（12以内）：
        温泉：単純温泉、重曹泉(美肌の湯)、塩化物泉(保温)、硫黄泉(血管を拡張させ)、
        食事店：バーベキュー、喫茶店、うなぎ屋、ラーメン屋、カレー、焼きそば
        プール：普通のプール、流水プール、ナイトプール、インフィニティプール
        飲み物店：タピオカ店、カフェ、茶室、バー、カルピス放題、酒場
        映画館：ホラー、れんあい、ＳＦ、アクション、コメディ、伝記
        カラオケ：一人でカラオケ、皆でカラオケ
        宿泊地：ホテル、キャンプ場
        手作り店：手作りお土産、手作アクセサリー
    背景系のスプライトアニメタルの座標を順に自分のPOSに保存して、書く時基準値を足すと正解が出る
    施設保存用の配列と同じ長さの配列でプレイヤーの位置を表示する、添え字で背景と施設を書く
    リゾート実体の大きさ: 720×60
    背景:   山・海・島・丘・雲・太陽・月(210×10)(30×10×7)
            ➝湖・船・鳥・スフィンクス・建物(270×30)(30×30×9)
            ➝施設・草・蟹・サボテン(720×40)(60×40)
    ぽちしたボタンの内容を前回と比べて、違いものでしたら保存して、内容のボタンの内容とイベント番号を変更する
    もしここがまだ確定されないならこの内容によって明滅で施設プロトタイプを書く
    もしプレイヤーが移動したら保存したものをリセット
    循環で確定された施設を書く
    GameStruct に声明する：施設の種類、各施設イベントの内容
    AppDeclared に保存する：各リゾート背景バッファ、施設保存用の配列、臨時的な施設保存用の配列
    +BuilderManager プレイヤー、矢印の位置、演出に関しての処理
    +BuildBackgroundShower プレイヤーの位置によって背景を表示
    +BuildingManager 施設作成や内容に関しての処理
    +BuildingShower 施設作成に関しての表示、演出処理
    +MoneyManager 資金に関しての処理
    【0201】プレイヤーの基礎処理が出来た、特別演出はまだ
    【0202】リゾート用の基本スプライトとアニメタル追加完了(雲の空白を直すの必要があるかも)
    【0202】突然の方向変換と作成してる座標リセットのバグを直した
    【0202】背景だけのスプライトの表現が出来た
    【0202】施設種類の可視性によってプレーヤーの移動に制限を加えた、各種類と内容のボタン番号も追加した
    【0203】施設作成の基礎を作った、描画はまだ、作成段階に時限を加える予定

### 第四段階
- [２月１５日まで]    ~~[２月１７日まで]~~    ~~[３月１日まで]~~
- 各ステージ作成、細かいところきれいにする

### 第五段階
- 余裕があれば、ネット機能を追加する